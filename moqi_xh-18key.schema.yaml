# Rime schema
# encoding: utf-8
# moqi_xh-18key: å¢¨å¥‡è¾…åŠ©ç  é¹¤æ‹¼ç‰ˆ - Android 18é”®ä¸“ç”¨
# åŸºäº moqi_xh-trime.schema.yamlï¼Œé’ˆå¯¹18é”®å…±é”®å¸ƒå±€ä¼˜åŒ–
# å…±é”®åŒæ‹¼è¾…åŠ©ç æ–¹æ¡ˆï¼šå¯é€‰1ä½è¾…åŠ©ç (æ— å¼•å¯¼ç¬¦) + å¼•å¯¼ç¬¦æ”¯æŒ2ä½è¾…åŠ©ç 

schema:
  schema_id: moqi_xh-18key
  name: MQ+XH 18é”®
  version: "0.1.0"
  author:
    - gaboolic (åŸå¢¨å¥‡ç )
    - hxlh50k (18é”®é€‚é…)
  description: |
    å¢¨å¥‡è¾…åŠ©ç  é¹¤æ‹¼ç‰ˆ - Android 18é”®ä¸“ç”¨
    å…±é”®åŒæ‹¼è¾…åŠ©ç æ–¹æ¡ˆï¼š
    - æ— å¼•å¯¼ç¬¦ï¼šçº¯éŸ³ç (2ä½) æˆ– ä¸‰ç (éŸ³ç 2+è¾…åŠ©ç 1)
    - æœ‰å¼•å¯¼ç¬¦[ï¼šéŸ³ç 2+è¾…åŠ©ç 2(ç”¨æˆ·å¯ä¸»åŠ¨åˆ†è¯)
  dependencies:
    - emoji
    - easy_en
    - jp_sela
    - moqi_big

# ========== Switches ==========
switches:
  - name: ascii_mode
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: traditionalization
    states: [ ç®€, ç¹ ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
  - name: big_char_set
    states: [ å¤§å­—é›†, å°å­—é›† ]
  - name: mars
    reset: 0
    states: [ åœ°, ç…‹ ]
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]

# ========== Menu ==========
menu:
  page_size: 9

# ========== Engine (18é”®å…±é”®åŒæ‹¼è¾…åŠ©ç ) ==========
engine:
  processors:
    # - lua_processor@*sharedkey_shuangpin_auxcode_processor  # å…±é”®åŒæ‹¼è¾…åŠ©ç å¤„ç†å™¨, æœ‰BUG
    - lua_processor@*sharedkey_shuangpin_precise_input_processor  # ç²¾ç¡®è¾“å…¥å¤„ç†å™¨ï¼ˆå¤„ç†å¤§å†™å­—æ¯ç²¾ç¡®è¾“å…¥ï¼‰
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - affix_segmentor@emojis
    - affix_segmentor@easy_en_simp
    - affix_segmentor@jp_sela
    - fallback_segmentor
  translators:
    # luaç¿»è¯‘å™¨
    - lua_translator@*date_translator
    - lua_translator@*lunar
    - lua_translator@*unicode
    - lua_translator@*number_translator
    - lua_translator@*calculator
    - punct_translator
    # ç è¡¨ç¿»è¯‘å™¨
    - table_translator@custom_phrase_3_code
    - table_translator@custom_phrase_kf
    - table_translator@custom_phrase_mqzg
    - table_translator@big_char_set
    - table_translator@emojis
    - table_translator@easy_en_simp
    - table_translator@jp_sela
    # è„šæœ¬ç¿»è¯‘å™¨
    - script_translator
    - script_translator@user_dict_set
  filters:
    # - lua_filter@*sharedkey_shuangpin_auxcode_filter  # å…±é”®åŒæ‹¼è¾…åŠ©ç è¿‡æ»¤å™¨
    - lua_filter@*pro_comment_format
    - lua_filter@*is_in_user_dict
    - reverse_lookup_filter@reverse_lookup
    - simplifier@emoji                        # Emojiè¿‡æ»¤å™¨
    - simplifier@chinese_english
    - simplifier@big_char_set
    - simplifier@traditionalize
    - simplifier@mars
    - lua_filter@*sharedkey_shuangpin_precise_input_filter        # ç²¾ç¡®è¾“å…¥è¿‡æ»¤å™¨ï¼ˆ18é”®å…±é”®ï¼‰
    - uniquifier                              # å»é‡ï¼ˆæ”¾åœ¨æœ€åï¼‰

# å¼•å…¥åŸºç¡€é…ç½®
__include: moqi.yaml:/phrase
__include: moqi.yaml:/opencc_config
__include: moqi.yaml:/big_char_and_user_dict

# ========== Emoji é…ç½® ==========
# ä» moqi.yaml å¼•å…¥ emoji simplifier é…ç½®
emoji:
  __include: moqi.yaml:/opencc_config/emoji

# ========== æ ‡ç‚¹é…ç½®ï¼ˆ18é”®ä¸“ç”¨ï¼‰ ==========
# ç¦ç”¨ / çš„å€™é€‰ï¼Œç›´æ¥è¾“å‡º /
punctuator:
  full_shape:
    __include: default:/punctuator/full_shape
  half_shape:
    __include: default:/punctuator/half_shape
    "/": "/"   # ç›´æ¥è¾“å‡º /ï¼Œä¸æ˜¾ç¤ºå€™é€‰

# ========== 18é”®ä¸“ç”¨ Speller é…ç½® ==========
speller:
  max_code_length: 6
  auto_select: false
  auto_select_pattern: ^[a-z]+/|^[a-df-zA-DF-Z]\w{3}|^e\w{4}|;[a-z]
  # alphabet åŒ…å«å¤§å†™å­—æ¯ç”¨äºç²¾ç¡®è¾“å…¥ï¼ŒåŒ…å« [ ç”¨äºå½¢ç å¼•å¯¼
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA[/|'
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  delimiter: " '"
  
  algebra:
    # ========== å…±é”®åŒæ‹¼è¾…åŠ©ç å¤„ç†è§„åˆ™ ==========
    #
    # æ–¹æ¡ˆè®¾è®¡ï¼š
    # - æ— å¼•å¯¼ç¬¦ï¼šçº¯éŸ³ç (2ä½) æˆ– ä¸‰ç (éŸ³ç 2+è¾…åŠ©ç 1)
    # - æœ‰å¼•å¯¼ç¬¦[ï¼šéŸ³ç 2+è¾…åŠ©ç 2ï¼Œç”¨æˆ·å¯ä¸»åŠ¨åˆ†è¯
    #
    # è¯å…¸æ ¼å¼: æ—¶ ui[oc
    # æ´¾ç”Ÿç¼–ç :
    #   - ui      : çº¯åŒæ‹¼
    #   - uio     : ä¸‰ç ï¼ŒéŸ³ç ui + è¾…åŠ©ç oï¼ˆæ— å¼•å¯¼ç¬¦ï¼‰
    #   - ui[o    : å¼•å¯¼ç¬¦+1ä½è¾…åŠ©ç ï¼ˆæ”¯æŒæ‰‹åŠ¨åˆ†è¯ï¼‰
    #   - ui[oc   : å¼•å¯¼ç¬¦+2ä½è¾…åŠ©ç 
    
    # === çº¯åŒæ‹¼ï¼ˆæ— è¾…åŠ©ç ï¼‰ ===
    - derive|^(.+)[[](\w)(\w)$|$1|              # çº¯åŒæ‹¼
    
    # === ä¸‰ç æ— å¼•å¯¼ç¬¦ï¼ˆéŸ³ç 2+è¾…åŠ©ç 1ï¼‰ ===
    - derive|^(..)[[](.)(\w)$|$1$2|             # éŸ³ç +ç¬¬1ä½è¾…åŠ©ç ï¼ˆæ— å¼•å¯¼ç¬¦ï¼‰
    
    # === æœ‰å¼•å¯¼ç¬¦æ—¶æ”¯æŒ1-2ä½è¾…åŠ©ç  ===
    # ç”¨æˆ·å¯ä¸»åŠ¨è¾“å…¥åˆ†è¯ç¬¦ï¼šsy[z'xi (1ä½è¾…åŠ©ç +åˆ†è¯ç¬¦)
    - derive|^(.+)[[](\w)(\w)$|$1[$2|           # åŒæ‹¼+[+1ä½è¾…åŠ©ç ï¼ˆæ”¯æŒæ‰‹åŠ¨åˆ†è¯ï¼‰
    - derive|^(.+)[[](\w)(\w)$|$1[$2$3|         # åŒæ‹¼+[+2ä½è¾…åŠ©ç ï¼ˆå®Œæ•´å››ç ï¼‰
    
    # ========== é£é”®è§„åˆ™ï¼ˆ18é”®å·²ç¦ç”¨ï¼Œä¸å…±é”®æ¨¡ç³Šå†²çªï¼‰==========
    # åŸç‰ˆé£é”®è§„åˆ™ä¼šä¸18é”®å…±é”®æ¨¡ç³Šå†²çªï¼Œä¾‹å¦‚ï¼š
    # - derive/^ww/wi/ ä¼šå¯¼è‡´ wi ä¼˜å…ˆåŒ¹é… ww è€Œé wo
    # å¯ä»¥å¼€å¯, ä½†æ˜¯è¾“å…¥ä½“éªŒæ›´ç³Ÿ
    # ä»¥ä¸‹è§„åˆ™å·²ç¦ç”¨ï¼š
    # - derive/^([y])j/$1f/
    # - derive/^qx/qw/
    # - derive/^xq/xo/
    # - derive/^qq/qo/
    # - derive/^ww/wi/
    # - derive/^j([a-twyz])/f$1/
    # - derive/^([y])h/$1g/
    # - derive/^([rsgv])c/$1n/
    
    # ========== 18é”®å…±é”®æ¨¡ç³Šï¼ˆéŸ³ç éƒ¨åˆ†ï¼šå£°æ¯ä½ç½®ï¼‰ ==========
    # WE å…±é”®
    - derive/^w([a-z])/e$1/
    - derive/^e([a-z])/w$1/
    # RT å…±é”®
    - derive/^r([a-z])/t$1/
    - derive/^t([a-z])/r$1/
    # IO å…±é”®
    - derive/^i([a-z])/o$1/
    - derive/^o([a-z])/i$1/
    # SD å…±é”®
    - derive/^s([a-z])/d$1/
    - derive/^d([a-z])/s$1/
    # FG å…±é”®
    - derive/^f([a-z])/g$1/
    - derive/^g([a-z])/f$1/
    # JK å…±é”®
    - derive/^j([a-z])/k$1/
    - derive/^k([a-z])/j$1/
    # XC å…±é”®
    - derive/^x([a-z])/c$1/
    - derive/^c([a-z])/x$1/
    # BN å…±é”®
    - derive/^b([a-z])/n$1/
    - derive/^n([a-z])/b$1/
    
    # ========== 18é”®å…±é”®æ¨¡ç³Šï¼ˆéŸ³ç éƒ¨åˆ†ï¼šéŸµæ¯ä½ç½®ï¼‰ ==========
    # åŒ¹é…ç¬¬2ä½å­—æ¯ï¼ˆéŸµæ¯ï¼‰ï¼Œåé¢å¯èƒ½æ˜¯ $ æˆ– [è¾…åŠ©ç 
    # WE å…±é”®
    - derive/^([a-z])w([^a-z]|$)/$1e$2/
    - derive/^([a-z])e([^a-z]|$)/$1w$2/
    # RT å…±é”®
    - derive/^([a-z])r([^a-z]|$)/$1t$2/
    - derive/^([a-z])t([^a-z]|$)/$1r$2/
    # IO å…±é”®
    - derive/^([a-z])i([^a-z]|$)/$1o$2/
    - derive/^([a-z])o([^a-z]|$)/$1i$2/
    # SD å…±é”®
    - derive/^([a-z])s([^a-z]|$)/$1d$2/
    - derive/^([a-z])d([^a-z]|$)/$1s$2/
    # FG å…±é”®
    - derive/^([a-z])f([^a-z]|$)/$1g$2/
    - derive/^([a-z])g([^a-z]|$)/$1f$2/
    # JK å…±é”®
    - derive/^([a-z])j([^a-z]|$)/$1k$2/
    - derive/^([a-z])k([^a-z]|$)/$1j$2/
    # XC å…±é”®
    - derive/^([a-z])x([^a-z]|$)/$1c$2/
    - derive/^([a-z])c([^a-z]|$)/$1x$2/
    # BN å…±é”®
    - derive/^([a-z])b([^a-z]|$)/$1n$2/
    - derive/^([a-z])n([^a-z]|$)/$1b$2/
    
    # ========== 18é”®å…±é”®æ¨¡ç³Šï¼ˆå½¢ç éƒ¨åˆ†ï¼šç¬¬1ä½ï¼‰ ==========
    # å½¢ç ä»¥ [ å¼•å¯¼ï¼Œéœ€è¦å¯¹ [åçš„å­—ç¬¦åº”ç”¨æ¨¡ç³Š
    # WE å…±é”®
    - derive/\[w/[e/
    - derive/\[e/[w/
    # RT å…±é”®
    - derive/\[r/[t/
    - derive/\[t/[r/
    # IO å…±é”®
    - derive/\[i/[o/
    - derive/\[o/[i/
    # SD å…±é”®
    - derive/\[s/[d/
    - derive/\[d/[s/
    # FG å…±é”®
    - derive/\[f/[g/
    - derive/\[g/[f/
    # JK å…±é”®
    - derive/\[j/[k/
    - derive/\[k/[j/
    # XC å…±é”®
    - derive/\[x/[c/
    - derive/\[c/[x/
    # BN å…±é”®
    - derive/\[b/[n/
    - derive/\[n/[b/
    
    # ========== 18é”®å…±é”®æ¨¡ç³Šï¼ˆè¾…åŠ©ç éƒ¨åˆ†ï¼šç¬¬2ä½ï¼Œæœ‰å¼•å¯¼ç¬¦ï¼‰ ==========
    # WE å…±é”®
    - derive/\[(\w)w$/[$1e/
    - derive/\[(\w)e$/[$1w/
    # RT å…±é”®
    - derive/\[(\w)r$/[$1t/
    - derive/\[(\w)t$/[$1r/
    # IO å…±é”®
    - derive/\[(\w)i$/[$1o/
    - derive/\[(\w)o$/[$1i/
    # SD å…±é”®
    - derive/\[(\w)s$/[$1d/
    - derive/\[(\w)d$/[$1s/
    # FG å…±é”®
    - derive/\[(\w)f$/[$1g/
    - derive/\[(\w)g$/[$1f/
    # JK å…±é”®
    - derive/\[(\w)j$/[$1k/
    - derive/\[(\w)k$/[$1j/
    # XC å…±é”®
    - derive/\[(\w)x$/[$1c/
    - derive/\[(\w)c$/[$1x/
    # BN å…±é”®
    - derive/\[(\w)b$/[$1n/
    - derive/\[(\w)n$/[$1b/
    
    # ========== 18é”®å…±é”®æ¨¡ç³Šï¼ˆä¸‰ç ï¼šæ— å¼•å¯¼ç¬¦è¾…åŠ©ç ï¼‰ ==========
    # ä¸‰ç æ ¼å¼ï¼šéŸ³ç 2ä½ + è¾…åŠ©ç 1ä½ï¼ˆæ— å¼•å¯¼ç¬¦ï¼‰
    # ä¾‹å¦‚ï¼šuio è¡¨ç¤º éŸ³ç ui + è¾…åŠ©ç o
    # éœ€è¦å¯¹ç¬¬3ä½åº”ç”¨å…±é”®æ¨¡ç³Š
    # WE å…±é”®
    - derive/^(..)w$/$1e/
    - derive/^(..)e$/$1w/
    # RT å…±é”®
    - derive/^(..)r$/$1t/
    - derive/^(..)t$/$1r/
    # IO å…±é”®
    - derive/^(..)i$/$1o/
    - derive/^(..)o$/$1i/
    # SD å…±é”®
    - derive/^(..)s$/$1d/
    - derive/^(..)d$/$1s/
    # FG å…±é”®
    - derive/^(..)f$/$1g/
    - derive/^(..)g$/$1f/
    # JK å…±é”®
    - derive/^(..)j$/$1k/
    - derive/^(..)k$/$1j/
    # XC å…±é”®
    - derive/^(..)x$/$1c/
    - derive/^(..)c$/$1x/
    # BN å…±é”®
    - derive/^(..)b$/$1n/
    - derive/^(..)n$/$1b/

# ========== Translator é…ç½® ==========
translator:
  dictionary: moqi.extended
  initial_quality: 10000
  enable_completion: false
  spelling_hints: 1
  comment_format:
    - "xform/(^|[ '])[^[]+[[]/$1/"   # ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†
  enable_user_dict: true

# ========== å¿«æ·é”®é…ç½®ï¼ˆæ‰‹æœºç‰ˆç®€åŒ–ï¼‰ ==========
key_binder:
  import_preset: default
  bindings:
    # åˆ†å·é€‰2
    - { when: has_menu, accept: semicolon, send: 2 }

# ========== Recognizer é…ç½® ==========
recognizer:
  patterns:
    punct:            # ç¦ç”¨ / å¼€å¤´çš„ç¬¦å·è¾“å…¥
    reverse_moqima:   # ç¦ç”¨ amq å¢¨å¥‡åæŸ¥
    radical_flypy:    # ç¦ç”¨ az éƒ¨ä»¶ç»„å­—
    reverse_stroke:   # ç¦ç”¨ ab ç¬”ç”»åæŸ¥
    reverse_cj:       # ç¦ç”¨ arj ä»“é¢‰åæŸ¥
    reverse_zrlf:     # ç¦ç”¨ alf è‡ªç„¶ä¸¤åˆ†
    add_user_dict:    # ç¦ç”¨ ac è‡ªé€ è¯
    emojis: "^ae[a-z]*'?$"      # å¯ç”¨ ae Emoji
    easy_en_simp: "^aw[a-z]*"   # å¯ç”¨ aw è‹±æ–‡å•è¯
    jp_sela: "^aj[a-z]*"        # å¯ç”¨ aj æ—¥è¯­

# è¯­è¨€æ¨¡å‹
__include: moqi:/octagram/enable_for_sentence

# 3ç å‡ºç®€è®©å…¨
custom_phrase_3_code:
  dictionary: ""
  user_dict: custom_phrase/custom_phrase_3_code
  db_class: stabledb
  enable_sentence: false
  enable_completion: false
  initial_quality: 1

# ========== 18é”®ç²¾ç¡®è¾“å…¥é…ç½® ==========
# ä¾› Lua è„šæœ¬è¯»å–
precise_input:
  # å…±é”®å¯¹é…ç½®
  fuzzy_pairs:
    - "we"
    - "rt"
    - "io"
    - "sd"
    - "fg"
    - "jk"
    - "xc"
    - "bn"

# ========== å…±é”®åŒæ‹¼è¾…åŠ©ç é…ç½® ==========
# ä¾› Lua è„šæœ¬è¯»å–
sharedkey_shuangpin_auxcode:
  # æ˜¯å¦å¯ç”¨
  enabled: true
  
  # è¾…åŠ©ç å¼•å¯¼ç¬¦
  auxcode_bracket: "["
  
  # ä¸‰ç æ¨¡å¼ï¼ˆæ— å¼•å¯¼ç¬¦æ—¶ï¼Œç¬¬3ä½ä½œä¸º1ä½è¾…åŠ©ç ï¼‰
  three_code_enabled: true
  
  # è¾…åŠ©ç æœ€å¤§é•¿åº¦
  max_auxcode_length: 2

# ========== å¼•å¯¼å‰ç¼€é…ç½®ï¼ˆajã€awã€aeï¼‰ ==========
# Emoji è¾“å…¥
emojis:
  tag: emojis
  dictionary: emoji
  enable_completion: true
  prefix: "ae"
  tips: " Emoji"

# è‹±æ–‡å•è¯è¾“å…¥
easy_en_simp:
  tag: easy_en_simp
  dictionary: easy_en
  enable_completion: true
  enable_sentence: false
  prefix: "aw"
  tips: "è‹±æ–‡å•è¯ï¼ˆå¯å»å…ƒéŸ³ï¼‰"
  spelling_hints: 9
  comment_format:
    - xform/^.+$//

# æ—¥è¯­è¾“å…¥
jp_sela:
  tag: jp_sela
  dictionary: jp_sela
  enable_completion: true
  enable_sentence: false
  prefix: "aj"
  tips: "æ—¥è¯­"
  spelling_hints: 9
  comment_format:
    - xform/^.+$//
